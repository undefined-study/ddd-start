# 1장. 도메인 모델 시작하기

## 📚 목차
- 1.1 도메인이란?
- 1.2 도메인 전문가와 개발자 간 지식 공유
- 1.3 도메인 모델
- 1.4 도메인 모델 패턴
- 1.5 도메인 모델 도출
- 1.6 엔티티와 밸류
    - 1.6.1 엔티티
    - 1.6.2 엔티티의 식별자 생성
    - 1.6.3 밸류 타입
    - 1.6.4 엔티티 식별자와 밸류 타입
    - 1.6.5 도메인 모델에 set 메서드 넣지 않기
- 1.7 도메인 용어와 유비쿼터스 언어

---

### 🔍 도메인이란?
소프트웨어로 해결하고자 하는 문제 영역을 의미한다. (ex. 온라인 서점)  
도메인은 다수의 하위 도메인으로 구성된다.

### 🔍 도메인 전문가와 개발자 간 지식 공유
요구사항을 올바르게 이해하지 못하면 요구하지 않은 엉뚱한 기능을 만들게 된다. 그래서 코딩에 앞서 요구사항을 올바르게 이해하는 것이 중요하다.  
요구사항을 올바르게 이해하기 위한 비교적 간단한 방법은 개발자와 도메인 전문가가 직접 대화하는 것이다. 

### 🔍 도메인 모델
도메인 모델은 특정 도메인을 개념적으로 표현한 것이다.  
도메인 모델을 사용하면 여러 관계자들이 동일한 모습으로 도메인을 이해하고 도메인 지식을 공유하는 데 도움이 된다.  
도메인에 따라 용어 의미가 결정되므로 여러 하위 도메인을 하나의 다이어그램에 모델링하면 안 된다. 모델의 각 구성요소는 특정 도메인으로 한정할 때 비로소 의미가 완전해지기 때문에 각 하위 도메인마다 별도로 모델을 만들어야 한다.

### 🔍 도메인 모델 패턴
- 애플리케이션의 아키텍처 영역과 역할
    |영역|설명|
    | --- | --- |
    |사용자 인터페이스 또는 표현|사용자의 요청을 처리하고 사용자에게 정보를 보여준다.|
    |응용|사용자가 요청한 기능을 실행한다.<br>업무로직을 직접 구현하지 않으며 도메인 계층을 조합해서 기능을 실행한다.|
    |**도메인**|**시스템이 제공할 도메인 규칙을 구현한다.**|
    |인프라스트럭처|데이터베이스나 메시징 시스템과 같은 외부 시스템과의 연동을 처리한다.|
도메인 모델 패턴은 아키텍처 상의 도메인 계층을 객체 지향 기법으로 구현하는 패턴을 말한다.  
핵심 규칙을 구현한 코드는 도메인 모델에만 위치하기 때문에 규칙이 바뀌거나 규칙을 확장해야 할 때 다른 코드에 영향을 덜 주고 변경 내역을 모델에 반영할 수 있게 된다.  
&rarr; `도메인 모델`이란 용어는 도메인 자체를 표현하는 개념적인 모델을 의미하지만, 도메인 계층을 구현할 때 사용하는 객체 모델을 언급할 때에도 사용한다.

### 🔍 도메인 모델 도출
도메인을 모델링할 때 기본이 되는 작업은 모델을 구성하는 핵심 구성요소, 규칙, 기능을 찾는 것이다.  
이 과정은 요구사항에서 출발한다.  

### 🔍 엔티티와 밸류
- #### 엔티티
    엔티티의 가장 큰 특징은 식별자를 가진다는 것이다.  
    식별자는 엔티티 객체마다 고유해서 각 엔티티는 서로 다른 식별자를 갖는다.  
    엔티티를 생성하고 속성을 바꾸고 삭제할 때까지 식별자는 유지된다.
- #### 엔티티의 식별자 생성
    엔티티의 식별자는 다음 중 한 가지 방식으로 생성한다.
    - 특정 규칙에 따라 생성
    - UUID나 [Nano ID](https://zelark.github.io/nano-id-cc/)와 같은 고유 식별자 생성기 사용
    - 값을 직접 입력
    - 일련번호 사용 (시퀀스나 DB의 자동 증가 칼럼 사용) 
- #### 밸류 타입
    밸류 타입은 개념적으로 완전한 하나를 표현할 때 사용한다.  
    ``` java
    public class Receiver{ //받는 사람
        private String name;
        private String phoneNumber;
    }
    ```
    - 밸류 타입의 장점
        - 밸류 타입을 위한 기능을 추가할 수 있다.
        - 코드의 의미를 더 잘 이해할 수 있도록 한다.

    밸류 객체의 데이터를 변경할 때는 기존 데이터를 변경하기보다는 변경한 데이터를 갖는 새로운 밸류 객체를 생성하는 방식을 선호한다.  
    데이터 변경 기능을 제공하지 않는 타입을 불변이라고 하는데, 밸류 타입을 불변으로 구현하는 가장 중요한 이유는 안전한 코드를 작성할 수 있다는 데 있다.
- #### 엔티티 식별자와 밸류 타입
    식별자를 위한 밸류 타입을 사용해서 의미가 잘 드러나도록 할 수 있다.  
    ``` java
    public class Order{
        // private String id; id라는 이름만으로는 해당 필드가 주문번호인지 알 수 없다.
        private OrderNo id; // OrderNo 타입 자체로 id가 주문번호임을 알 수 있다.
    }
    ```
- #### 도메인 모델에 set 메서드 넣지 않기
    - set 메서드의 문제점
        1. set 메서드는 도메인의 핵심 개념이나 의도를 코드에서 사라지게 한다.  
        set 메서드는 필드값만 변경하고 끝나기 때문에 상태 변경과 관련된 도메인 지식이 코드에서 사라지게 된다.  
        2. set 메서드를 사용하면 도메인 객체를 생성할 때 온전하지 않은 상태가 될 수 있다.  
        도메인 객체가 불완전한 상태로 사용되는 것을 막으려면 생성 시점에 필요한 것을 전달해 주어야 한다. 즉, 생성자를 통해 필요한 데이터를 모두 받아야 한다.  
        생성자로 필요한 것을 모두 받으면 생성자를 호출하는 시점에 필요한 데이터가 올바른지 검사할 수 있다.  
        
    &rarr; set 메서드를 구현해야 할 특별한 이유가 없다면 불변 타입의 장점을 살릴 수 있도록 밸류 타입은 불변으로 구현한다.

### 🔍 도메인 용어와 유비쿼터스 언어
코드를 작성할 때 도메인에서 사용하는 용어는 매우 중요하다.  
도메인에서 사용하는 용어를 코드에 반영하지 않으면 그 코드는 개발자에게 코드의 의미를 해석해야 하는 부담을 준다.  

- 유비쿼터스 언어

    어디서나 사용되는 언어  
    전문가, 관계자, 개발자가 도메인과 관련된 공통의 언어를 만들고 이를 대화, 문서, 도메인 모델, 코드, 테스트 등 모든 곳에서 같은 용어를 사용한다.  
    이렇게 하면 소통 과정에서 발생하는 용어의 모호함을 줄일 수 있고 개발자는 도메인과 코드 사이에서 불필요한 해석 과정을 줄일 수 있다.
