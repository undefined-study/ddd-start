# 9장. 도메인 모델과 바운디드 컨텍스트

## 📚 목차
- 9.1 도메인 모델과 경계
- 9.2 바운디드 컨텍스트
- 9.3 바운디드 컨텍스트 구현
- 9.4 바운디드 컨텍스트 간 통합
- 9.5 바운디드 컨텍스트 간 관계
- 9.6 컨텍스트 맵

---

### 🔍 도메인 모델과 경계
한 도메인은 다시 여러 하위 도메인으로 구분되기 때문에 한 개의 모델로 여러 하위 도메인으로 구분되기 때문에 한 개의 모델로 여러 하위 도메인을 모두 표현하려고 시도하면 오히려 모든 하위 도메인에 맞지 않는 모델을 만들게 된다.  
논리적으로 같은 존재처럼 보이지만 하위 도메인에 따라 다른 용어를 사용하는 경우도 있다.  
(ex. 시스템을 사용하는 사람 &rarr; 회원 도메인: 회원, 주문 도메인: 주문자)  
하위 도메인마다 사용하는 용어가 다르기 때문에 올바른 도메인 모델을 개발하려면 하위 도메인마다 모델을 만들어야 한다.  
각 모델은 명시적으로 구분되는 경계를 가져서 섞이지 않도록 해야 한다.  
여러 하위 도메인 모델이 섞이기 시작하면 모델의 의미가 약해질 뿐만 아니라 여러 도메인의 모델이 서로 얽히기 때문에 각 하위 도메인별로 다르게 발전하는 요구사항을 모델에 반영하기 어려워진다.  
모델은 특정한 컨텍스트(문맥) 하에서 완전한 의미를 갖는다.  
이렇게 구분되는 경계를 갖는 컨텍스트를 DDD에서는 **바운디드 컨텍스트**라고 부른다.  

### 🔍 바운디드 컨텍스트
바운디드 컨텍스트는 모델의 경계를 결정하며 한 개의 바운디드 컨텍스트는 논리적으로 한 개의 모델을 갖는다.  
바운디드 컨텍스트는 용어를 기준으로 구분한다.  
또한 바운디드 컨텍스트는 실제로 사용자에게 기능을 제공하는 물리적 시스템으로 도메인 모델은 이 바운디드 컨텍스트 안에서 도메인을 구현한다.  
이상적으로 하위 도메인과 바운디드 컨텍스트가 일대일 관계를 가지면 좋겠지만 현실은 그렇지 않을 때가 많다.   
여러 하위 도메인을 하나의 바운디드 컨텍스트에서 개발할 때 주의할 점은 하위 도메인의 모델이 섞이지 않도록 하는 것이다.  
전체 하위 도메인을 위한 단일 모델을 만들게 되면 도메인 모델이 개별 하위 도메인을 제대로 반영하지 못해서 하위 도메인별로 기능을 확장하기 어렵게 되고 이는 서비스 경쟁력을 떨어뜨리는 원인이 된다.  
한 개의 바운디드 컨텍스트가 여러 하위 도메인을 포함하더라도 하위 도메인마다 구분되는 패키지를 갖도록 구현해야 하며, 이렇게 함으로써 하위 도메인을 위한 모델이 서로 뒤섞이지 않고 하위 도메인마다 바운디드 컨텍스트를 갖는 효과를 낼 수 있다.  
바운디드 컨텍스트는 도메인 모델을 구분하는 경계가 되기 때문에 바운디드 컨텍스트는 구현하는 하위 도메인에 알맞은 모델을 표함한다.  

### 🔍 바운디드 컨텍스트 구현
바운디드 컨텍스트는 도메인 모델 뿐만 아니라 표현 영역, 응용 서비스, 인프라스트럭처 영역을 모두 포함한다.  
도메인 모델의 데이터 구조가 바뀌면 DB 테이블 스키마도 함께 변경해야 하므로 테이블도 바운디드 컨텍스트에 포함된다.  
모든 바운디드 컨텍스트를 반드시 도메인 주도로 개발할 필요는 없다.  
또한 각 바운디드 컨텍스트는 서로 다른 구현 기술을 사용할 수도 있다.  

### 🔍 바운디드 컨텍스트 간 통합
두 팀이 관련된 바운디드 컨텍스트를 개발하면 자연스럽게 두 바운디드 컨텍스트 간 통합이 발생한다.  
가능하다.  
#### 💡 마이크로서비스와 바운디드 컨텍스트  
마이크로서비스의 특징은 바운디드 컨텍스트와 잘 어울린다.  
각 바운디드 컨텍스트는 모델의 경계를 형성하는데 바운디드 컨텍스트를 마이크로서비스로 구현하면 자연스럽게 컨텍스트별로 모델이 분리된다. 
별도 프로세스로 개발한 바운디드 컨텍스트는 독립적으로 배포하고 모니터링하며 확장되는데 이 역시 마이크로서비스가 갖는 특징이다.  

### 🔍 바운디드 컨텍스트 간 관계
바운디드 컨텍스트는 어떤 식으로든 연결되기 때문에 두 바운디드 컨텍스트는 다양한 방식으로 관계를 맺는다.  
가장 흔한 관계는 한 쪽에서 API를 호출하는 관계이다. REST API가 대표적이다.  
상류 컴포넌트(API를 제공하는 쪽)는 일종의 서비스 공급자 역할을 하며 하류 컴포넌트(API를 제공 받는 쪽)는 그 서비스를 사용하는 고객 역할을 한다.  
상류 컴포넌트는 보통 하류 컴포넌트가 사용할 수 있는 통신 프로토콜을 정의하고 이를 공개한다.  
서비스를 제공할 하류 컴포넌트가 많다면 각 하류 팀의 요구사항을 수용해서 이를 단일 서비스로 공개하기도 하는데, 이런 서비스를 **공개 호스트 서비스**라고 한다. (ex. 검색 기능)  
상류 컴포넌트의 서비스는 상류 바운디드 컨텍스트의 도메인 모델을 따르기 때문에 하류 컴포넌트는 상류 서비스의 모델이 자신의 도메인 모델에 영향을 주지 않도록 보호해 주는 완충 지대를 만들어야 한다.  
두 바운디드 컨텍스트가 같은 모델을 공유하는 경우도 있는데, 이런 모델을 **공유 커널**이라고 부른다.  
공유 커널의 장점은 중복을 줄여준다는 것이다.  
서로 통합하지 않는 방식도 있는데, 이를 **독립 방식**이라고 한다.  
독립 방식은 두 바운디드 컨텍스트 간에 통합하지 않으므로 서로 독립적으로 모델을 발전시킨다.  
독립 방식에서 두 바운디드 컨텍스트 간의 통합은 수동으로 이루어진다.  
수동으로 통합하는 방식은 규모가 커질 수록 한계에 직면하기 때문에 규모가 커지기 시작하면 두 바운디드 컨텍스트를 통합해야 할 수도 있다.

### 🔍 컨텍스트 맵
개별 바운디드 컨텍스트에 매몰되면 전체를 보지 못할 때가 있다.  
이를 방지하려면 전체 비즈니스를 조망할 수 있는 지도가 필요한데 그것이 바로 컨텍스트 맵이다.  
바운디드 컨텍스트 영역에 주요 애그리거트를 함께 표시하면 모델에 대한 관계가 더 명확히 드러난다.  
컨텍스트 맵은 시스템의 전체 구조를 보여준다.  
이는 하위 도메인과 일치하지 않는 바운디드 컨텍스트를 찾아 도메인에 맞게 바운디드 컨텍스트를 조절하고 사업의 핵심 도메인을 위해 조직 역량을 어떤 바운디드 컨텍스트에 집중할지 파악하는 데 도움을 준다.  
컨텍스트 맵을 그리는 규칙은 따로 없다.
